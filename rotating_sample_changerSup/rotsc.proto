Terminator = '\r';
ReplyTimeout = 2000;

getID {
    out "id";
    in "%/(.{0,39})/";
	ExtraInput = Ignore;
}

getStat {
    out "st";
	in "%16s %(\$1\$2)3s %(\$1\$3)02d %(\$1\$4)02d";
}

getPosition {
    out "po";
	in "Position = %02d";
}

getVR {
    out "vr%(\$1\$2)#04i";
	in "%(\$1\$3){+|-} VR %*i = %i hx %*x";
	ExtraInput = Ignore;
}

sendCommand {
	out "\$1";
	in "ok";
	@mismatch {in "rf-%(\$2)i";}
}

moveWithLower {
	out "ma%#02i";
	in "ok";
	@mismatch {in "rf-%(\$1)i";}
	@init {getPosition;}
}

moveNoLower {
	out "mn%#02i";
	in "ok";
	@mismatch {in "rf-%(\$1)i";}
	@init {getPosition;}
}